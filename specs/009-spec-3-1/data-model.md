# Data Model: Maintenance & Updates

This feature does not introduce any new persistent data models to the application's database. The focus is on processes and transient data structures used during the maintenance scripts' execution.

## Transient Data Structures

### 1. Dependency Audit Report

This structure represents the JSON output from the `npm audit` command. The maintenance script will parse this to identify vulnerabilities.

**Source**: `npm audit --json`
**Consumed by**: `monitor-vulnerabilities.sh`

**Schema (Simplified)**:
```json
{
  "auditReportVersion": 2,
  "vulnerabilities": {
    "some-dependency": {
      "name": "some-dependency",
      "severity": "critical",
      "via": [
        {
          "source": "some-other-dependency",
          "name": "some-other-dependency",
          "dependency": "some-dependency",
          "title": "Vulnerability Title",
          "url": "https://github.com/advisories/GHSA-xxxx-xxxx-xxxx",
          "severity": "critical"
        }
      ],
      "effects": [],
      "range": "<=1.2.3",
      "nodes": [
        "node_modules/some-dependency"
      ],
      "fixAvailable": true
    }
  },
  "metadata": {
    "vulnerabilities": {
      "info": 0,
      "low": 0,
      "moderate": 0,
      "high": 1,
      "critical": 1
    },
    "dependencies": 500
  }
}
```

### 2. API Documentation Checksum

A simple structure to store the checksum of the fetched API documentation to detect changes.

**Source**: Generated by `regenerate-embeddings.sh`
**Consumed by**: `regenerate-embeddings.sh`

**Schema**:
```json
{
  "url": "https://developer.atlassian.com",
  "checksum": "sha256-checksum-of-the-content",
  "lastChecked": "2025-09-25T10:00:00Z"
}
```
This file will be stored locally within the project, for example at `.specify/state/api-checksum.json`.

### 3. Health Metrics

The structure of the metrics exposed by the `/health` endpoint for Prometheus.

**Source**: `prom-client` in the MCP server
**Consumed by**: Prometheus scraper

**Example Prometheus Exposition Format**:
```
# HELP mcp_server_health_status Current health status of the server. 1 for healthy, 0 for unhealthy.
# TYPE mcp_server_health_status gauge
mcp_server_health_status 1

# HELP http_request_duration_seconds Duration of HTTP requests in seconds.
# TYPE http_request_duration_seconds histogram
http_request_duration_seconds_bucket{le="0.1",method="GET",route="/health"} 1
http_request_duration_seconds_bucket{le="0.5",method="GET",route="/health"} 1
http_request_duration_seconds_sum{method="GET",route="/health"} 0.05
http_request_duration_seconds_count{method="GET",route="/health"} 1
```
